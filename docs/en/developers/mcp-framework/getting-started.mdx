export const metadata = {
  title: "Getting Started",
  description: "Build your first MCP server with the TypeScript MCP Template",
};

**Ready to build your first MCP server?** This guide walks you through creating a complete Model Context Protocol server using our TypeScript template. You'll learn the core concepts while building real tools that AI agents can use.

## What We'll Build

By the end of this guide, you'll have a fully functional MCP server with:

- üß∞ **Custom Tools**: Functions that AI agents can call
- üìö **Resources**: Data sources agents can read
- üí≠ **Prompts**: Reusable prompt templates
- üåê **WebSocket & SSE Support**: Real-time communication protocols
- üöÄ **Cloudflare Deployment**: Production-ready hosting

## Quick Setup

### 1. Initialize Your Project

```bash
# Install the nullshot CLI globally (use pnpm to avoid permission issues)
pnpm add -g @nullshot/cli

# Create a new MCP server from template
nullshot create mcp
choose your project name: eg: my-mcp-server

cd my-mcp-server (this is where your project is)
```

This creates:

- Adds `dev` script to package.json that will start the MCP server in dev mode
- Adds some wrangler scripts for building and deploying your MCP server
- Adds `cf-typegen` for Cloudflare Workers type generation

### 2. Start Development

```bash
# Run all services in development mode
pnpm run dev
```

The MCP Inspector will automatically open at `http://localhost:6274` and your MCP server will run on `http://localhost:8787`. The Inspector should automatically connect using SSE transport at `http://localhost:8787/sse`.

## Understanding the Architecture

### Project Structure

```
my-mcp-server/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ index.ts      # Main entry point and routing
‚îÇ   ‚îú‚îÄ‚îÄ server.ts     # MCP server implementation
‚îÇ   ‚îú‚îÄ‚îÄ tools.ts      # Tool definitions
‚îÇ   ‚îú‚îÄ‚îÄ resources.ts  # Resource definitions
‚îÇ   ‚îî‚îÄ‚îÄ prompts.ts    # Prompt templates
‚îú‚îÄ‚îÄ wrangler.jsonc    # Cloudflare configuration
‚îî‚îÄ‚îÄ package.json      # Dependencies and scripts
```

## Core Implementation

### 1. Main Entry Point (`src/index.ts`)

The entry point handles routing and protocol negotiation:

```typescript
// Worker entrypoint for handling incoming requests
export default {
  async fetch(
    request: Request,
    env: Env,
    ctx: ExecutionContext
  ): Promise<Response> {
    const url = new URL(request.url);
    const sessionIdStr = url.searchParams.get("sessionId");
    const id = sessionIdStr
      ? env.MCP_SERVER.idFromString(sessionIdStr)
      : env.MCP_SERVER.newUniqueId();

    console.log(`Fetching sessionId: ${sessionIdStr} with id: ${id}`);

    url.searchParams.set("sessionId", id.toString());

    return env.MCP_SERVER.get(id).fetch(new Request(url.toString(), request));
  },
};
```

The above forwards requets to a dedicated MCP server which supports the following with zero configuration:

**Key Features:**

- **Health Check**: Simple endpoint to verify server status
- **WebSocket Support**: Real-time bidirectional communication
- **SSE Support**: Server-sent events for streaming responses
- **Durable Objects**: Persistent, stateful server instances

### 2. MCP Server Implementation (`src/server.ts`)

The server extends our MCP framework and configures tools, resources, and prompts:

```typescript
import { McpHonoServerDO } from "@nullshot/mcp-framework";
import { setupServerTools } from "./tools";
import { setupServerResources } from "./resources";
import { setupServerPrompts } from "./prompts";

export class ExampleMcpServer extends McpHonoServerDO<Env> {
  // Required: Define server metadata
  getImplementation(): Implementation {
    return {
      name: "ExampleMcpServer",
      version: "1.0.0",
    };
  }

  // Configure all server capabilities
  configureServer(server: McpServer): void {
    // Add tools (functions agents can call)
    setupServerTools(server);

    // Add resources (data agents can read)
    setupServerResources(server);

    // Add prompts (templates agents can use)
    setupServerPrompts(server);
  }
}
```

**Key Concepts:**

- **Implementation**: Metadata about your MCP server
- **Tools**: Functions that agents can execute
- **Resources**: Data sources agents can access
- **Prompts**: Reusable prompt templates

### 3. Building Your First Tool (`src/tools.ts`)

Tools are functions that AI agents can call. Here's a simple "Hello World" example:

```typescript
import { McpServer } from "@modelcontextprotocol/sdk/server/mcp.js";
import { z } from "zod";

export function setupServerTools(server: McpServer) {
  // Hello World Tool - A simple greeting function
  server.tool(
    "hello-world", // Tool name
    "Say hello to someone", // Description for the AI
    {
      // Parameters schema using Zod
      name: z.string().describe("Name of the person to greet"),
      language: z
        .enum(["english", "spanish", "french"])
        .optional()
        .describe("Language for greeting"),
    },
    async ({ name, language = "english" }) => {
      // Tool implementation
      const greetings = {
        english: `Hello, ${name}! üëã`,
        spanish: `¬°Hola, ${name}! üëã`,
        french: `Bonjour, ${name}! üëã`,
      };

      const greeting = greetings[language] || greetings.english;

      return {
        content: [
          {
            type: "text",
            text: greeting,
          },
        ],
      };
    }
  );

  // Advanced Tool - Get current time with formatting
  server.tool(
    "get-current-time",
    "Get the current date and time with optional formatting",
    {
      format: z
        .enum(["iso", "human", "timestamp"])
        .optional()
        .describe("Output format"),
      timezone: z
        .string()
        .optional()
        .describe("Timezone (e.g., America/New_York)"),
    },
    async ({ format = "human", timezone = "UTC" }) => {
      const now = new Date();

      let timeString: string;
      switch (format) {
        case "iso":
          timeString = now.toISOString();
          break;
        case "timestamp":
          timeString = now.getTime().toString();
          break;
        case "human":
        default:
          timeString = now.toLocaleString("en-US", {
            timeZone: timezone,
            weekday: "long",
            year: "numeric",
            month: "long",
            day: "numeric",
            hour: "2-digit",
            minute: "2-digit",
            second: "2-digit",
          });
      }

      return {
        content: [
          {
            type: "text",
            text: `Current time: ${timeString} (${timezone})`,
          },
        ],
      };
    }
  );

  // Utility Tool - Generate random number
  server.tool(
    "random-number",
    "Generate a random number within a specified range",
    {
      min: z.number().describe("Minimum value (inclusive)"),
      max: z.number().describe("Maximum value (inclusive)"),
      decimals: z.number().optional().describe("Number of decimal places"),
    },
    async ({ min, max, decimals = 0 }) => {
      if (min > max) {
        throw new Error("Minimum value cannot be greater than maximum value");
      }

      const random = Math.random() * (max - min) + min;
      const result =
        decimals > 0 ? Number(random.toFixed(decimals)) : Math.floor(random);

      return {
        content: [
          {
            type: "text",
            text: `Random number: ${result}`,
          },
        ],
      };
    }
  );
}
```

**Tool Development Best Practices:**

1. **Clear Naming**: Use descriptive, hyphenated names
2. **Rich Descriptions**: Help AI understand when to use your tool
3. **Schema Validation**: Use Zod for type-safe parameter validation
4. **Error Handling**: Provide helpful error messages
5. **Structured Output**: Return consistent response formats

### 4. Adding Resources (`src/resources.ts`)

Resources are data sources that agents can read:

```typescript
import { McpServer } from "@modelcontextprotocol/sdk/server/mcp.js";

export function setupServerResources(server: McpServer) {
  // Simple text resource
  server.resource(
    "greeting-templates",
    "resource://greeting-templates",
    async (uri: URL) => {
      const templates = {
        formal: "Good day, {name}. I hope this message finds you well.",
        casual: "Hey {name}! What's up?",
        business: "Dear {name}, Thank you for your time.",
        friendly: "Hi there {name}! Hope you're having a great day!",
      };

      return {
        contents: [
          {
            uri: uri.href,
            mimeType: "application/json",
            text: JSON.stringify(templates, null, 2),
          },
        ],
      };
    }
  );

  // Dynamic resource with parameters
  server.resource(
    "system-info",
    "resource://system-info/{category}",
    async (uri: URL) => {
      const category = uri.pathname.split("/").pop();

      const systemInfo = {
        server: {
          name: "ExampleMcpServer",
          version: "1.0.0",
          uptime: process.uptime(),
          timestamp: new Date().toISOString(),
        },
        capabilities: {
          tools: ["hello-world", "get-current-time", "random-number"],
          resources: ["greeting-templates", "system-info"],
          prompts: ["code-review", "explain-concept"],
        },
      };

      const data =
        category && systemInfo[category as keyof typeof systemInfo]
          ? systemInfo[category as keyof typeof systemInfo]
          : systemInfo;

      return {
        contents: [
          {
            uri: uri.href,
            mimeType: "application/json",
            text: JSON.stringify(data, null, 2),
          },
        ],
      };
    }
  );
}
```

### 5. Creating Prompts (`src/prompts.ts`)

Prompts are reusable templates that help AI agents:

```typescript
import { McpServer } from "@modelcontextprotocol/sdk/server/mcp.js";

export function setupServerPrompts(server: McpServer) {
  // Code review prompt
  server.prompt("code-review", "Generate a thorough code review", (args) => ({
    messages: [
      {
        role: "user",
        content: {
          type: "text",
          text: `Please review this code and provide feedback:

${args?.code || "[No code provided]"}

Focus on:
- Code quality and best practices
- Security considerations  
- Performance optimizations
- Maintainability improvements

Language: ${args?.language || "Unknown"}`,
        },
      },
    ],
  }));

  // Concept explanation prompt
  server.prompt(
    "explain-concept",
    "Explain a concept clearly and simply",
    (args) => ({
      messages: [
        {
          role: "user",
          content: {
            type: "text",
            text: `Please explain "${args?.concept || "[No concept provided]"}" in simple terms.

Target audience: ${args?.audience || "General audience"}
Detail level: ${args?.level || "Beginner"}

Include:
- Clear definition
- Real-world examples
- Common misconceptions (if any)
- Why it matters`,
          },
        },
      ],
    })
  );
}
```

## Test locally

1. run `pnpm run dev`
2. Go to the `http://localhost:6724` and enter in the mcp server `http://localhost:8787/sse` and start testing with MCP Inspector

_Soon you can use the Playground to test MCPs!_

## Deployment to Production

### 1. Deploy to Cloudflare

```bash
# Deploy your MCP server
npx wrangler deploy
```

### 2. Use Your MCP Server

Once deployed, your MCP server will be available at:

- **WebSocket**: `wss://your-worker.workers.dev/ws`
- **SSE**: `https://your-worker.workers.dev/sse`

## Next Steps

### Expand Your Server

1. **Add More Tools**: Create tools for file operations, API integrations, calculations
2. **Dynamic Resources**: Connect to databases, APIs, or file systems
3. **Advanced Prompts**: Create domain-specific prompt templates
4. **Error Handling**: Implement robust error handling and retries

### Integration Examples

```typescript
// File system tool
server.tool(
  "read-file",
  "Read file contents",
  {
    path: z.string().describe("File path to read"),
  },
  async ({ path }) => {
    const content = await Deno.readTextFile(path);
    return { content: [{ type: "text", text: content }] };
  }
);

// API integration tool
server.tool(
  "weather",
  "Get weather information",
  {
    location: z.string().describe("City name or coordinates"),
  },
  async ({ location }) => {
    const weather = await fetch(
      `https://api.weather.com/v1/current?location=${location}`
    );
    const data = await weather.json();
    return { content: [{ type: "text", text: JSON.stringify(data) }] };
  }
);
```

### Advanced Patterns

- **Stateful Tools**: Use Durable Objects for persistent state
- **Streaming Tools**: Implement real-time data streams
- **Composite Tools**: Chain multiple operations together
- **Authenticated Tools**: Add authentication and authorization

## Resources

- **[MCP Template Repository](https://github.com/null-shot/mcp-template)** - Complete source code
- **[MCP Integration Testing](/en/developers/mcp-framework/integration-testing)** - Comprehensive testing guide with utilities
- **[MCP Specification](https://modelcontextprotocol.io/)** - Official protocol documentation
- **[Agent Framework](/en/developers/agents-framework/overview)** - Integrate with AI agents
- **[Platform Services](/en/developers/platform/overview)** - Backend services for MCP servers

---

üéâ **Congratulations!** You've built your first MCP server. Your tools are now ready to be used by AI agents across any platform that supports the Model Context Protocol.
